Single trait GWAS

0 - Checks
1 - Extract kinship from GData or compute kinship

--- loop over environments

	2 - Add covariates to phenotypic data
	3 - Extract traits / convert numerical trait columns to character values
	
	--- loop over traits
	
		4 - Remove missing values and select relevant columns
		5 - Get genotypes for which trait is not missing
		6 - Remove redundant rows/columns from kinship based on 5
		7 - Compute variance components
			- EMMA algorithm
			- sommer (NR algorithm)
		8 - Compute allele frequencies
		9 - Determine segregating markers
		10 - Exclude markers identical to markers in SNP Covariates
		11 - Run fastGLS for segregating markers except 10
		12 - Run fastGLS for SNP Covariates
		13 - Compute genomic inflation factor and optionally correct pValues for it
		14 - Optionally add gene info
		15 - Determine LOD threshold
		16 - Determine significant SNPs and optionally SNPs close to those SNPs
	
	--- end loop
	
	17 - Merge output over traits 

--- end loop

18 - Merge output over environments	


Multi trait GWAS

0 - checks

1 - Optionally subset markers
2 - Extract kinship from GData or compute kinship
3 - Get genotypes for which trait is not missing
4 - Remove redundant rows/columns from kinship based on 3
5 - Add covariates to phenotypic data
6 - Compute variance components
	- Unstructured model
	- Pairwise unstructured model
	- Factor Analytic model
7 - Compute allele frequencies
8 - Determine segregating markers
9 - Exclude markers identical to markers in SNP Covariates
10 - Estimate effects
11 - Estimate effects for SNP Covariates
12 - Merge output